```markdown
# –£—Ç–∏–ª–∏—Ç—ã

–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ—á–µ–µ.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —É—Ç–∏–ª–∏—Ç

```
src/main/java/com/example/bankcards/util/
‚îî‚îÄ‚îÄ CardNumberEncryptor.java     # –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –∫–∞—Ä—Ç
```

## üîê CardNumberEncryptor

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –∫–∞—Ä—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

```java
@Component
public class CardNumberEncryptor {
    private static final String ALGORITHM = "AES/GCM/NoPadding";
    private static final int KEY_SIZE = 256;
    private static final int IV_LENGTH = 12;
    private static final int TAG_LENGTH = 128;
    private static final String SECRET_KEY = "0123456789abcdef0123456789abcdef";
}
```

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **ALGORITHM**: AES/GCM/NoPadding
- **KEY_SIZE**: 256 –±–∏—Ç
- **IV_LENGTH**: 12 –±–∞–π—Ç
- **TAG_LENGTH**: 128 –±–∏—Ç
- **SECRET_KEY**: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

## üîí –ú–µ—Ç–æ–¥—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### encrypt(String cardNumber)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î

```java
public String encrypt(String cardNumber) {
    // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
}
```

**–ü—Ä–æ—Ü–µ—Å—Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:**
1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ IV
2. –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–ª—é—á–∞ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ GCM
3. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã
4. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ IV –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
5. –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Base64

### decrypt(String encryptedData)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏—è

```java
public String decrypt(String encryptedData) {
    // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
}
```

**–ü—Ä–æ—Ü–µ—Å—Å –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:**
1. –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ Base64 —Å—Ç—Ä–æ–∫–∏
2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ IV –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è cipher –≤ —Ä–µ–∂–∏–º–µ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
4. –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
5. –í–æ–∑–≤—Ä–∞—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã

## üé≠ –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### maskCardNumber(String fullNumber)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

```java
public static String maskCardNumber(String fullNumber) {
    if (fullNumber == null || fullNumber.length() < 4) return "****";
    String lastFour = fullNumber.substring(fullNumber.length() - 4);
    return "**** **** **** " + lastFour;
}
```

**–§–æ—Ä–º–∞—Ç –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏—è:**
- –í—Ö–æ–¥: `4111111111111234`
- –í—ã—Ö–æ–¥: `**** **** **** 1234`

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê–ª–≥–æ—Ä–∏—Ç–º AES-GCM
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- –°–ª—É—á–∞–π–Ω—ã–π IV
- –î–ª–∏–Ω–∞ –∫–ª—é—á–∞ 256 –±–∏—Ç

## üîÑ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö

### CardService
```
// –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–∞—Ä—Ç—ã
String encrypted = encryptor.encrypt(createDTO.getCardNumberPlain());
card.setCardNumberEncrypted(encrypted);

// –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–≤–µ—Ç–∞
String decrypted = encryptor.decrypt(card.getCardNumberEncrypted());
dto.setMaskedCardNumber(CardNumberEncryptor.maskCardNumber(decrypted));
```

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
- –ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã —à–∏—Ñ—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ –ë–î
- –î–µ—à–∏—Ñ—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏
- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É
```